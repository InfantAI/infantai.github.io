import{d as L,r as n,N as V,h as u,o as P,e as H,w as o,a,i as g,t as k,u as m,a0 as w,M as c}from"./index-c831df68.js";import{b as G,u as J}from"./doll-1c3c9639.js";import{g as Q}from"./getAuth-ef464080.js";const W={name:"",statusFlag:1,image:"",language:"",remarks:"",titleImg:"",deviceImgs:[],batchNumber:""},x=L({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},data:Object},emits:["update:visible","fetchData"],setup(U,{emit:D}){const f=Q(),y=n([]),r=n([]),I=n([]),z=n(),C=n(),M=n({closeOnEscKeydown:!1}),v=n({size:500,unit:"KB"}),b=U,d=n(!1),l=n(b.data),B=e=>{l.value.statusFlag=e},_=({file:e})=>{c.error(`文件 ${e.name} 上传失败`)},N=async({validateResult:e,firstError:t})=>{e?(l.value.deviceImgs=r.value.map(p=>({img:p.response.data})),l.value.id?await J(l.value).then(()=>{c.success("提交成功")}):await G(l.value).then(()=>{c.success("提交成功")}),console.log("result",l.value),d.value=!1,F("fetchData")):(console.log("Errors: ",e),c.warning(t))},T=({response:e})=>{console.log("response",e),l.value.image=e.data},A=e=>{console.log("Batch Upload",e),console.log(r.value)},E=({response:e})=>{console.log("response",e),l.value.titleImg=e.data},R=()=>{d.value=!1,Object.assign(l.value,W)},F=D;V(()=>d.value,e=>{F("update:visible",e)}),V(()=>b.visible,e=>{d.value=e}),V(()=>b.data,e=>{l.value=e});const q={name:[{required:!0,message:"请输入产品名称",type:"error"}],statusFlag:[{required:!0,message:"请选择是否启用",type:"error"}]};return(e,t)=>{const p=u("t-input"),i=u("t-form-item"),S=u("t-radio-button"),O=u("t-radio-group"),h=u("t-upload"),$=u("t-button"),j=u("t-form"),K=u("t-dialog");return P(),H(K,{visible:d.value,"onUpdate:visible":t[5]||(t[5]=s=>d.value=s),top:40,header:e.$t("pages.dollModel.create"),width:680,footer:!1},{body:o(()=>[a(j,{ref:"form",data:l.value,rules:q,"label-width":100,onSubmit:N},{default:o(()=>[a(i,{label:e.$t("pages.dollModel.dollName"),name:"name"},{default:o(()=>[a(p,{modelValue:l.value.name,"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.name=s),style:{width:"480px"}},null,8,["modelValue"])]),_:1},8,["label"]),a(i,{label:e.$t("pages.dollModel.dollStatus"),name:"statusFlag"},{default:o(()=>[a(O,{"default-value":"1",onChange:B},{default:o(()=>[a(S,{value:"1"},{default:o(()=>[g(k(e.$t("pages.dollModel.dollStatusEnum.on")),1)]),_:1}),a(S,{value:"2"},{default:o(()=>[g(k(e.$t("pages.dollModel.dollStatusEnum.off")),1)]),_:1})]),_:1})]),_:1},8,["label"]),a(i,{label:e.$t("pages.dollModel.dollDescription"),name:"description"},{default:o(()=>[a(p,{modelValue:l.value.remarks,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.remarks=s),style:{width:"480px"}},null,8,["modelValue"])]),_:1},8,["label"]),a(i,{label:e.$t("pages.dollModel.dallMainImg"),name:"type"},{default:o(()=>[a(h,{ref_key:"uploadRef1",ref:z,modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),"image-viewer-props":M.value,headers:m(f),"size-limit":v.value,action:m(w),theme:"image",accept:"image/*","auto-upload":!0,onFail:_,onSuccess:T},null,8,["modelValue","image-viewer-props","headers","size-limit","action"])]),_:1},8,["label"]),a(i,{label:e.$t("pages.dollModel.dallImages"),name:"mark"},{default:o(()=>[a(h,{ref_key:"uploadRef2",ref:C,modelValue:r.value,"onUpdate:modelValue":t[3]||(t[3]=s=>r.value=s),headers:m(f),action:m(w),theme:"image",tips:e.$t("pages.dollModel.imageTips"),accept:"image/*","size-limit":v.value,"auto-upload":!0,multiple:!0,max:5,onFail:_,onSuccess:A},null,8,["modelValue","headers","action","tips","size-limit"])]),_:1},8,["label"]),a(i,{label:e.$t("pages.dollModel.dallTitleImg"),name:"type"},{default:o(()=>[a(h,{ref:"uploadRef3",modelValue:I.value,"onUpdate:modelValue":t[4]||(t[4]=s=>I.value=s),"image-viewer-props":M.value,headers:m(f),"size-limit":v.value,action:m(w),theme:"image",accept:"image/*","auto-upload":!0,onFail:_,onSuccess:E},null,8,["modelValue","image-viewer-props","headers","size-limit","action"])]),_:1},8,["label"]),a(i,{style:{float:"right"}},{default:o(()=>[a($,{variant:"outline",onClick:R},{default:o(()=>[g("取消")]),_:1}),a($,{theme:"primary",type:"submit"},{default:o(()=>[g("确定")]),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{W as I,x as _};
