import{d as L,r as u,N as w,h as n,o as P,e as H,w as t,a as l,i as g,t as $,u as m,a0 as y,M as c}from"./index-9eb1327f.js";import{b as G,u as J}from"./doll-6053fa5a.js";import{g as Q}from"./getAuth-466d5628.js";const W={name:"",statusFlag:1,image:"",language:"",remarks:"",titleImg:"",deviceImgs:[],batchNumber:"",id:""},x=L({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},data:Object},emits:["update:visible","fetchData"],setup(k,{emit:U}){const v=Q(),f=u([]),r=u([]),b=u([]),z=u(),C=u(),M=u({closeOnEscKeydown:!1}),_=u({size:500,unit:"KB"}),h=k,d=u(!1),a=u(h.data),B=e=>{a.value.statusFlag=e},V=({file:e})=>{c.error(`文件 ${e.name} 上传失败`)},N=async({validateResult:e,firstError:o})=>{e?(a.value.deviceImgs=r.value.map(p=>({img:p.response.data})),a.value.id?await J(a.value).then(()=>{c.success("提交成功")}):await G(a.value).then(()=>{c.success("提交成功")}),console.log("result",a.value),d.value=!1,D("fetchData")):(console.log("Errors: ",e),c.warning(o))},T=({response:e})=>{console.log("response",e),a.value.image=e.data},A=e=>{console.log("Batch Upload",e),console.log(r.value)},E=({response:e})=>{console.log("response",e),a.value.titleImg=e.data},R=()=>{d.value=!1,Object.assign(a.value,W)},D=U;w(()=>d.value,e=>{D("update:visible",e)}),w(()=>h.visible,e=>{console.log("val>>>>",e),d.value=e,console.log("formData>>>",a.value),e&&a.value.id&&(b.value=[{url:a.value.titleImg}],f.value=[{url:a.value.image}],r.value=a.value.deviceImgs)}),w(()=>h.data,e=>{a.value=e,console.log("formData",a)});const q={name:[{required:!0,message:"请输入产品名称",type:"error"}],statusFlag:[{required:!0,message:"请选择是否启用",type:"error"}]};return(e,o)=>{const p=n("t-input"),i=n("t-form-item"),F=n("t-radio-button"),O=n("t-radio-group"),I=n("t-upload"),S=n("t-button"),j=n("t-form"),K=n("t-dialog");return P(),H(K,{visible:d.value,"onUpdate:visible":o[5]||(o[5]=s=>d.value=s),top:40,header:e.$t("pages.dollModel.create"),width:680,footer:!1},{body:t(()=>[l(j,{ref:"form",data:a.value,rules:q,"label-width":100,onSubmit:N},{default:t(()=>[l(i,{label:e.$t("pages.dollModel.dollName"),name:"name"},{default:t(()=>[l(p,{modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=s=>a.value.name=s),style:{width:"480px"}},null,8,["modelValue"])]),_:1},8,["label"]),l(i,{label:e.$t("pages.dollModel.dollStatus"),name:"statusFlag"},{default:t(()=>[l(O,{"default-value":"1",onChange:B},{default:t(()=>[l(F,{value:"1"},{default:t(()=>[g($(e.$t("pages.dollModel.dollStatusEnum.on")),1)]),_:1}),l(F,{value:"2"},{default:t(()=>[g($(e.$t("pages.dollModel.dollStatusEnum.off")),1)]),_:1})]),_:1})]),_:1},8,["label"]),l(i,{label:e.$t("pages.dollModel.dollDescription"),name:"description"},{default:t(()=>[l(p,{modelValue:a.value.remarks,"onUpdate:modelValue":o[1]||(o[1]=s=>a.value.remarks=s),style:{width:"480px"}},null,8,["modelValue"])]),_:1},8,["label"]),l(i,{label:e.$t("pages.dollModel.dallMainImg"),name:"type"},{default:t(()=>[l(I,{ref_key:"uploadRef1",ref:z,modelValue:f.value,"onUpdate:modelValue":o[2]||(o[2]=s=>f.value=s),"image-viewer-props":M.value,headers:m(v),"size-limit":_.value,action:m(y),theme:"image",accept:"image/*","auto-upload":!0,onFail:V,onSuccess:T},null,8,["modelValue","image-viewer-props","headers","size-limit","action"])]),_:1},8,["label"]),l(i,{label:e.$t("pages.dollModel.dallImages"),name:"mark"},{default:t(()=>[l(I,{ref_key:"uploadRef2",ref:C,modelValue:r.value,"onUpdate:modelValue":o[3]||(o[3]=s=>r.value=s),headers:m(v),action:m(y),theme:"image",tips:e.$t("pages.dollModel.imageTips"),accept:"image/*","size-limit":_.value,"auto-upload":!0,multiple:!0,max:5,onFail:V,onSuccess:A},null,8,["modelValue","headers","action","tips","size-limit"])]),_:1},8,["label"]),l(i,{label:e.$t("pages.dollModel.dallTitleImg"),name:"type"},{default:t(()=>[l(I,{ref:"uploadRef3",modelValue:b.value,"onUpdate:modelValue":o[4]||(o[4]=s=>b.value=s),"image-viewer-props":M.value,headers:m(v),"size-limit":_.value,action:m(y),theme:"image",accept:"image/*","auto-upload":!0,onFail:V,onSuccess:E},null,8,["modelValue","image-viewer-props","headers","size-limit","action"])]),_:1},8,["label"]),l(i,{style:{float:"right"}},{default:t(()=>[l(S,{variant:"outline",onClick:R},{default:t(()=>[g("取消")]),_:1}),l(S,{theme:"primary",type:"submit"},{default:t(()=>[g("确定")]),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{W as I,x as _};
