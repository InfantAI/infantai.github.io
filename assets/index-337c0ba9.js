import{d as Q,r as f,j as S,C as U,h as s,o as _,e as v,w as t,a,i as c,t as h,u as g,$ as V,c as j,F as q,q as z,b as l,a1 as A,M as o,g as E}from"./index-b9cef0b8.js";import{f as H,h as O,i as P,j as R}from"./train-2a0ab77e.js";import{g as T}from"./getAuth-f297cd07.js";const G={class:"tdesign-demo-image-viewer__ui-image tdesign-demo-image-viewer__base"},J=["src"],K=Q({__name:"index",setup(W){const d=f(!1),w=()=>d.value=!0,y=T(),b=["https://gadget-oss.oss-ap-southeast-5.aliyuncs.com/instaanswer/test/file/1703682265797.png"],i=f([]),x=S(()=>i.value.map(e=>e.image)),C=async()=>{await H(b).then(()=>{o.success("重置成功"),r()})},k=async e=>{if(i.value.length<=1){o.error("至少要保留一个");return}await O(e.id).then(()=>{o.success("删除成功"),r()})},F=({file:e})=>{o.error(`文件 ${e.name} 上传失败`)},I=async({file:e,response:n})=>{console.log(n),await P(n.data).then(()=>{o.success(`文件 ${e.name} 上传成功`),r()})},r=async()=>{await R().then(e=>{i.value=e})};return U(()=>{r()}),(e,n)=>{const u=s("t-button"),L=s("t-upload"),$=s("t-row"),B=s("t-popconfirm"),D=s("t-image-viewer"),M=s("t-card");return _(),v(M,null,{default:t(()=>[a($,null,{default:t(()=>[a(u,{ghost:"",onClick:C},{default:t(()=>[c(h(e.$t("pages.setting.reset")),1)]),_:1}),a(L,{"auto-upload":"",headers:g(y),"trigger-button-props":{theme:"primary",variant:"base"},action:g(V),style:{marginLeft:"40px"},onFail:F,onSuccess:I},{default:t(()=>[a(u,{theme:"primary"},{default:t(()=>[c(h(e.$t("pages.setting.reupload")),1)]),_:1})]),_:1},8,["headers","action"])]),_:1}),(_(!0),j(q,null,z(i.value,(m,N)=>(_(),v(D,{key:m.id,visible:d.value,"onUpdate:visible":n[0]||(n[0]=p=>d.value=p),"default-index":N,images:x.value},{trigger:t(()=>[l("div",G,[l("img",{alt:"test",src:m.image,class:"tdesign-demo-image-viewer__ui-image--img"},null,8,J),l("div",{class:"tdesign-demo-image-viewer__ui-image--hover",onClick:w},[l("span",null,[a(g(A),{size:"1.4em"}),c(" 预览 ")])]),a(B,{content:"确认删除吗",onConfirm:p=>k(m)},{default:t(()=>[a(u,{theme:"danger",ghost:"",style:{"margin-top":"80%"}},{default:t(()=>[c("删除")]),_:1})]),_:2},1032,["onConfirm"])])]),_:2},1032,["visible","default-index","images"]))),128))]),_:1})}}});const ee=E(K,[["__scopeId","data-v-4145f1a5"]]);export{ee as default};
