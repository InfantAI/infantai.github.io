import{c as T,d as E,e as O}from"./doll-ffa8bb99.js";import{P as q}from"./index-5e92a7a3.js";import{I as h,_ as Z}from"./DialogForm.vue_vue_type_script_setup_true_lang-e035a930.js";import{d as G,r as l,j as H,C as J,h as i,o as c,c as v,b as g,a as n,w as _,i as K,t as Q,e as y,u as R,Z as W,I as z,F as x,q as X,M as C,g as Y}from"./index-ab78ae36.js";import"./more-4af32ce4.js";import"./getAuth-a52a02e1.js";const ee={class:"list-card-operation"},ae={class:"search-input"},te={class:"list-card-items"},oe={class:"list-card-pagination"},le={key:1,class:"list-card-loading"},ne={name:"ListCard"},se=G({...ne,setup(ie){const a=l({current:1,pageSize:12,total:0}),u=l(void 0),b=l([]),m=l(!0),s=async()=>{try{const e=await T({language:"",page:{pageIndex:a.value.current,pageSize:a.value.pageSize}});b.value=e.content,a.value={...a.value,total:e.totalCount}}catch(e){console.log(e)}finally{m.value=!1}},S=H(()=>u.value?`确认删除后${u.value.name}的所有产品信息将被清空, 且无法恢复`:"");J(()=>{s()});const r=l(!1),f=l(""),p=l(!1),d=l({...h}),V=e=>{a.value.pageSize=e,a.value.current=1,s()},D=e=>{a.value.current=e,s()},w=e=>{p.value=!0,u.value=e},I=async()=>{console.log("deleteProduct.value",u.value),await E(u.value.id).then(()=>{C.success("删除成功"),s()}).catch(e=>{console.log(e),C.error(e.message)}).finally(()=>{p.value=!1})},M=()=>{u.value=void 0,d.value={...h}},k=e=>{r.value=!0,Object.assign(d.value,e),console.log(d.value)},P=()=>{r.value=!0,Object.assign(d.value,h)},U=async e=>{let t=0;e.statusFlag===1?t=2:t=1,console.log("product",e),await O(e.id,t),await s(),C.success("")};return(e,t)=>{const L=i("t-button"),N=i("t-input"),$=i("t-col"),B=i("t-row"),F=i("t-pagination"),j=i("t-loading"),A=i("t-dialog");return c(),v("div",null,[g("div",ee,[n(L,{onClick:P},{default:_(()=>[K(Q(e.$t("pages.dollModel.create")),1)]),_:1}),g("div",ae,[n(N,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=o=>f.value=o),placeholder:e.$t("pages.dollModel.placeholder"),clearable:"",onEnter:s},{"suffix-icon":_(()=>[f.value===""?(c(),y(R(W),{key:0,size:"var(--td-comp-size-xxxs)"})):z("",!0)]),_:1},8,["modelValue","placeholder"])])]),n(Z,{visible:r.value,"onUpdate:visible":t[1]||(t[1]=o=>r.value=o),data:d.value,onFetchData:s},null,8,["visible","data"]),a.value.total>0&&!m.value?(c(),v(x,{key:0},[g("div",te,[n(B,{gutter:[16,16]},{default:_(()=>[(c(!0),v(x,null,X(b.value.slice(a.value.pageSize*(a.value.current-1),a.value.pageSize*a.value.current),o=>(c(),y($,{key:o.index,lg:4,xs:6,xl:3},{default:_(()=>[n(q,{class:"list-card-item",product:o,onDeleteItem:w,onManageProduct:k,onUpdateStatus:U},null,8,["product"])]),_:2},1024))),128))]),_:1})]),g("div",oe,[n(F,{modelValue:a.value.current,"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.current=o),"page-size":a.value.pageSize,"onUpdate:pageSize":t[3]||(t[3]=o=>a.value.pageSize=o),total:a.value.total,"page-size-options":[12,24,36],onPageSizeChange:V,onCurrentChange:D},null,8,["modelValue","page-size","total"])])],64)):m.value?(c(),v("div",le,[n(j,{size:"large",text:e.$t("pages.dollModel.placeholder")},null,8,["text"])])):z("",!0),n(A,{visible:p.value,"onUpdate:visible":t[4]||(t[4]=o=>p.value=o),header:e.$t("pages.dollModel.deleteConfirm"),body:S.value,"on-cancel":M,onConfirm:I},null,8,["visible","header","body"])])}}});const ge=Y(se,[["__scopeId","data-v-970a14fc"]]);export{ge as default};
